<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Demo - Full Interactive</title>
    <link rel="icon" type="image/x-icon" href="../Icons/FavIco.ICO">
    <link rel="stylesheet" href="win3x-theme.css">
    <link rel="stylesheet" href="win3x-skin-3.1.css">
    <link rel="stylesheet" href="desktop-icons.css">
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: 'MS Sans Serif', 'Microsoft Sans Serif', sans-serif;
            font-size: 11px;
        }

        /* THE UNIVERSE: Initial blank desktop */
        .universe {
            background: var(--desktop-bg);
            width: 100vw;
            height: 100vh;
            position: relative;
            overflow: hidden;
        }

        /* Desktop icons in Universe */
        .universe .desktop-icons {
            display: grid;
            grid-template-columns: repeat(auto-fill, 80px);
            grid-auto-rows: 90px;
            gap: 8px 16px;
            padding: 20px;
            align-content: start;
        }

        /* Minimized window icon - sits directly on desktop */
        .window-icon {
            position: absolute;
            width: 100px;
            height: 32px;
            background: var(--button-bg);
            border: 1px solid var(--border);
            box-shadow: inset -1px -1px 0 var(--button-dark),
                        inset 1px 1px 0 var(--button-light);
            display: flex;
            align-items: center;
            padding: 2px 4px;
            cursor: pointer;
            font-size: 11px;
            user-select: none;
        }

        .window-icon:active {
            box-shadow: inset 1px 1px 0 var(--button-dark);
        }

        .window-icon .icon-symbol {
            width: 16px;
            height: 14px;
            background: var(--button-bg);
            border: 1px solid var(--border);
            box-shadow: inset -1px -1px 0 var(--button-dark),
                        inset 1px 1px 0 var(--button-light);
            margin-right: 4px;
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .window-icon .icon-symbol::after {
            content: '';
            width: 8px;
            height: 2px;
            background: var(--window-fg);
        }

        .window-icon .icon-title {
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .window-icon.dragging {
            opacity: 0.7;
            z-index: 9999;
        }

        /* Draggable window styles - positioning and interaction only */
        .window.draggable {
            position: absolute;
            cursor: default;
            overflow: hidden;
        }

        .window.draggable .title-bar {
            cursor: move;
        }

        .window.draggable.maximized .title-bar {
            cursor: default;
        }

        .window.draggable .window-body {
            overflow: auto;
        }

        /* Resize handles */
        .window.draggable .resize-handle {
            position: absolute;
            background: transparent;
        }

        .window.draggable .resize-handle.n { top: -3px; left: 3px; right: 3px; height: 6px; cursor: n-resize; }
        .window.draggable .resize-handle.s { bottom: -3px; left: 3px; right: 3px; height: 6px; cursor: s-resize; }
        .window.draggable .resize-handle.e { right: -3px; top: 3px; bottom: 3px; width: 6px; cursor: e-resize; }
        .window.draggable .resize-handle.w { left: -3px; top: 3px; bottom: 3px; width: 6px; cursor: w-resize; }
        .window.draggable .resize-handle.nw { top: -3px; left: -3px; width: 8px; height: 8px; cursor: nw-resize; }
        .window.draggable .resize-handle.ne { top: -3px; right: -3px; width: 8px; height: 8px; cursor: ne-resize; }
        .window.draggable .resize-handle.sw { bottom: -3px; left: -3px; width: 8px; height: 8px; cursor: sw-resize; }
        .window.draggable .resize-handle.se { bottom: -3px; right: -3px; width: 8px; height: 8px; cursor: se-resize; }

        .window.draggable.maximized .resize-handle { display: none; }
        .window.draggable.minimized { display: none; }

        /* MY LIFE content styles - container for nested windows */
        .mylife-content {
            position: relative;
            background: white;
            min-height: 100%;
            /* No padding - windows are absolutely positioned */
        }

        /* Priorities Window - now a real draggable window */
        .priorities-window {
            width: 320px;
            height: 380px;
        }

        .priorities-content {
            padding: 12px;
        }

        .priority-item {
            border: 1px solid var(--border);
            padding: 12px;
            margin-bottom: 12px;
            background: white;
            display: flex;
            gap: 12px;
        }

        .priority-rank {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: var(--button-bg);
            border: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            flex-shrink: 0;
        }

        .priority-content {
            flex: 1;
            min-width: 0;
        }

        .priority-text {
            font-size: 11px;
            line-height: 1.4;
            margin-bottom: 4px;
        }

        .priority-meta {
            font-size: 10px;
            color: var(--button-dark);
        }

        /* Topic Card - now a real draggable window */
        .topic-card {
            width: 220px;
            height: 180px;
        }

        /* Topic card content layout */
        .topic-card .window-body {
            padding: 12px;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        /* Priority badges removed - priorities now linked as entities */

        .topic-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
        }

        .topic-icon {
            width: 32px;
            height: 32px;
            border: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: center;
            background: white;
        }

        .topic-icon img {
            width: 28px;
            height: 28px;
            image-rendering: pixelated;
        }

        .topic-name {
            font-size: 12px;
            font-weight: bold;
            flex: 1;
        }

        .topic-ideas-count {
            font-size: 10px;
            font-weight: bold;
            padding: 4px 8px;
            border: 1px solid var(--border);
            text-align: center;
            margin-bottom: 8px;
            background: rgba(0,0,0,0.05);
        }

        .topic-actions {
            margin-top: auto;
            display: flex;
            gap: 8px;
        }

        .topic-btn {
            flex: 1;
            min-width: 0;
            font-size: 10px;
        }

        /* Priority rank colors removed - priorities are now entities */
    </style>
</head>
<body>
    <!-- THE UNIVERSE: The blank desktop - contains icon(s) to open desktops -->
    <div class="universe" id="universe">
        <!-- Universe Icons -->
        <div class="desktop-icons" id="universe-icons">
            <div class="desktop-icon" tabindex="0" id="mylife-icon">
                <div class="desktop-icon-image">
                    <img src="../Icons/PROGM001.ICO" alt="My Life">
                </div>
                <div class="desktop-icon-label">My Life</div>
            </div>
        </div>

        <!-- MY LIFE: Desktop window containing topics (opens from Universe) -->
        <div class="window draggable active" id="mylife-window"
             style="left: 40px; top: 30px; width: calc(100% - 80px); height: calc(100% - 60px); display: none;"
             data-restore-left="40" data-restore-top="30"
             data-restore-width="calc(100% - 80px)" data-restore-height="calc(100% - 60px)">
            <!-- Resize handles -->
            <div class="resize-handle n"></div>
            <div class="resize-handle s"></div>
            <div class="resize-handle e"></div>
            <div class="resize-handle w"></div>
            <div class="resize-handle nw"></div>
            <div class="resize-handle ne"></div>
            <div class="resize-handle sw"></div>
            <div class="resize-handle se"></div>

            <div class="title-bar">
                <div class="title-bar-controls">
                    <button class="system-menu" aria-label="System menu"></button>
                </div>
                <div class="title-bar-text">My Life</div>
                <div class="title-bar-controls">
                    <button data-minimize aria-label="Minimize"></button>
                    <button data-maximize aria-label="Maximize"></button>
                </div>
            </div>
            <div class="window-body">
                <div class="mylife-content" id="mylife-content">
                    <!-- Top Priorities Window -->
                    <div class="window draggable priorities-window" id="priorities-window"
                         style="left: 20px; top: 20px;">
                        <!-- Resize handles -->
                        <div class="resize-handle n"></div>
                        <div class="resize-handle s"></div>
                        <div class="resize-handle e"></div>
                        <div class="resize-handle w"></div>
                        <div class="resize-handle nw"></div>
                        <div class="resize-handle ne"></div>
                        <div class="resize-handle sw"></div>
                        <div class="resize-handle se"></div>

                        <div class="title-bar">
                            <div class="title-bar-controls">
                                <button class="system-menu" aria-label="System menu"></button>
                            </div>
                            <div class="title-bar-text">Top 5 Priorities</div>
                            <div class="title-bar-controls">
                                <button data-minimize aria-label="Minimize"></button>
                                <button data-maximize aria-label="Maximize"></button>
                            </div>
                        </div>
                        <div class="window-body priorities-content">
                                <div class="priority-item">
                                    <div class="priority-rank">1</div>
                                    <div class="priority-content">
                                        <div class="priority-text">Complete dashboard demo with interactive windows</div>
                                        <div class="priority-meta">Work → "Ship dashboard" (Urgent)</div>
                                    </div>
                                </div>
                                <div class="priority-item">
                                    <div class="priority-rank">2</div>
                                    <div class="priority-content">
                                        <div class="priority-text">Review Win 3.1 specifications for menu bar</div>
                                        <div class="priority-meta">Work → "Ship dashboard" (High)</div>
                                    </div>
                                </div>
                                <div class="priority-item">
                                    <div class="priority-rank">3</div>
                                    <div class="priority-content">
                                        <div class="priority-text">Schedule dentist appointment</div>
                                        <div class="priority-meta">Health → "Get healthy" (Current)</div>
                                    </div>
                                </div>
                                <div class="priority-item">
                                    <div class="priority-rank">4</div>
                                    <div class="priority-content">
                                        <div class="priority-text">Plan weekend photography trip</div>
                                        <div class="priority-meta">Photography → "Build portfolio" (Attention soon)</div>
                                    </div>
                                </div>
                                <div class="priority-item">
                                    <div class="priority-rank">5</div>
                                    <div class="priority-content">
                                        <div class="priority-text">Organize kitchen cabinets</div>
                                        <div class="priority-meta">Living → (no priority)</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    <!-- Work -->
                    <div class="window draggable topic-card" id="topic-work"
                         style="left: 360px; top: 20px;">
                        <div class="resize-handle n"></div>
                        <div class="resize-handle s"></div>
                        <div class="resize-handle e"></div>
                        <div class="resize-handle w"></div>
                        <div class="resize-handle nw"></div>
                        <div class="resize-handle ne"></div>
                        <div class="resize-handle sw"></div>
                        <div class="resize-handle se"></div>
                        <div class="title-bar">
                            <div class="title-bar-controls">
                                <button class="system-menu" aria-label="System menu"></button>
                            </div>
                            <div class="title-bar-text">Work</div>
                            <div class="title-bar-controls">
                                <button data-minimize aria-label="Minimize"></button>
                                <button data-maximize aria-label="Maximize"></button>
                            </div>
                        </div>
                        <div class="window-body">
                            <div class="topic-header">
                                <div class="topic-icon">
                                    <img src="../Icons/Work.ICO" alt="Work">
                                </div>
                                <div class="topic-name">Work</div>
                            </div>
                            <div class="topic-ideas-count">12 IDEAS</div>
                            <div class="topic-actions">
                                <button class="topic-btn">EDIT</button>
                                <button class="topic-btn">VIEW</button>
                            </div>
                        </div>
                    </div>

                    <!-- Health -->
                    <div class="window draggable topic-card" id="topic-health"
                         style="left: 600px; top: 20px;">
                        <div class="resize-handle n"></div>
                        <div class="resize-handle s"></div>
                        <div class="resize-handle e"></div>
                        <div class="resize-handle w"></div>
                        <div class="resize-handle nw"></div>
                        <div class="resize-handle ne"></div>
                        <div class="resize-handle sw"></div>
                        <div class="resize-handle se"></div>
                        <div class="title-bar">
                            <div class="title-bar-controls">
                                <button class="system-menu" aria-label="System menu"></button>
                            </div>
                            <div class="title-bar-text">Health</div>
                            <div class="title-bar-controls">
                                <button data-minimize aria-label="Minimize"></button>
                                <button data-maximize aria-label="Maximize"></button>
                            </div>
                        </div>
                        <div class="window-body">
                            <div class="topic-header">
                                <div class="topic-icon">
                                    <img src="../Icons/hearts.ICO" alt="Health">
                                </div>
                                <div class="topic-name">Health</div>
                            </div>
                            <div class="topic-ideas-count">8 IDEAS</div>
                            <div class="topic-actions">
                                <button class="topic-btn">EDIT</button>
                                <button class="topic-btn">VIEW</button>
                            </div>
                        </div>
                    </div>

                    <!-- Photography -->
                    <div class="window draggable topic-card" id="topic-photography"
                         style="left: 840px; top: 20px;">
                        <div class="resize-handle n"></div>
                        <div class="resize-handle s"></div>
                        <div class="resize-handle e"></div>
                        <div class="resize-handle w"></div>
                        <div class="resize-handle nw"></div>
                        <div class="resize-handle ne"></div>
                        <div class="resize-handle sw"></div>
                        <div class="resize-handle se"></div>
                        <div class="title-bar">
                            <div class="title-bar-controls">
                                <button class="system-menu" aria-label="System menu"></button>
                            </div>
                            <div class="title-bar-text">Photography</div>
                            <div class="title-bar-controls">
                                <button data-minimize aria-label="Minimize"></button>
                                <button data-maximize aria-label="Maximize"></button>
                            </div>
                        </div>
                        <div class="window-body">
                            <div class="topic-header">
                                <div class="topic-icon">
                                    <img src="../Icons/Photography.ICO" alt="Photography">
                                </div>
                                <div class="topic-name">Photography</div>
                            </div>
                            <div class="topic-ideas-count">6 IDEAS</div>
                            <div class="topic-actions">
                                <button class="topic-btn">EDIT</button>
                                <button class="topic-btn">VIEW</button>
                            </div>
                        </div>
                    </div>

                    <!-- Living -->
                    <div class="window draggable topic-card" id="topic-living"
                         style="left: 360px; top: 220px;">
                        <div class="resize-handle n"></div>
                        <div class="resize-handle s"></div>
                        <div class="resize-handle e"></div>
                        <div class="resize-handle w"></div>
                        <div class="resize-handle nw"></div>
                        <div class="resize-handle ne"></div>
                        <div class="resize-handle sw"></div>
                        <div class="resize-handle se"></div>
                        <div class="title-bar">
                            <div class="title-bar-controls">
                                <button class="system-menu" aria-label="System menu"></button>
                            </div>
                            <div class="title-bar-text">Living</div>
                            <div class="title-bar-controls">
                                <button data-minimize aria-label="Minimize"></button>
                                <button data-maximize aria-label="Maximize"></button>
                            </div>
                        </div>
                        <div class="window-body">
                            <div class="topic-header">
                                <div class="topic-icon">
                                    <img src="../Icons/Living.ICO" alt="Living">
                                </div>
                                <div class="topic-name">Living</div>
                            </div>
                            <div class="topic-ideas-count">9 IDEAS</div>
                            <div class="topic-actions">
                                <button class="topic-btn">EDIT</button>
                                <button class="topic-btn">VIEW</button>
                            </div>
                        </div>
                    </div>

                    <!-- Relationships -->
                    <div class="window draggable topic-card" id="topic-relationships"
                         style="left: 600px; top: 220px;">
                        <div class="resize-handle n"></div>
                        <div class="resize-handle s"></div>
                        <div class="resize-handle e"></div>
                        <div class="resize-handle w"></div>
                        <div class="resize-handle nw"></div>
                        <div class="resize-handle ne"></div>
                        <div class="resize-handle sw"></div>
                        <div class="resize-handle se"></div>
                        <div class="title-bar">
                            <div class="title-bar-controls">
                                <button class="system-menu" aria-label="System menu"></button>
                            </div>
                            <div class="title-bar-text">Relationships</div>
                            <div class="title-bar-controls">
                                <button data-minimize aria-label="Minimize"></button>
                                <button data-maximize aria-label="Maximize"></button>
                            </div>
                        </div>
                        <div class="window-body">
                            <div class="topic-header">
                                <div class="topic-icon">
                                    <img src="../Icons/Relationships.ICO" alt="Relationships">
                                </div>
                                <div class="topic-name">Relationships</div>
                            </div>
                            <div class="topic-ideas-count">4 IDEAS</div>
                            <div class="topic-actions">
                                <button class="topic-btn">EDIT</button>
                                <button class="topic-btn">VIEW</button>
                            </div>
                        </div>
                    </div>

                    <!-- Life Admin -->
                    <div class="window draggable topic-card" id="topic-lifeadmin"
                         style="left: 840px; top: 220px;">
                        <div class="resize-handle n"></div>
                        <div class="resize-handle s"></div>
                        <div class="resize-handle e"></div>
                        <div class="resize-handle w"></div>
                        <div class="resize-handle nw"></div>
                        <div class="resize-handle ne"></div>
                        <div class="resize-handle sw"></div>
                        <div class="resize-handle se"></div>
                        <div class="title-bar">
                            <div class="title-bar-controls">
                                <button class="system-menu" aria-label="System menu"></button>
                            </div>
                            <div class="title-bar-text">Life Admin</div>
                            <div class="title-bar-controls">
                                <button data-minimize aria-label="Minimize"></button>
                                <button data-maximize aria-label="Maximize"></button>
                            </div>
                        </div>
                        <div class="window-body">
                            <div class="topic-header">
                                <div class="topic-icon">
                                    <img src="../Icons/LifeAdmin.ICO" alt="Life Admin">
                                </div>
                                <div class="topic-name">Life Admin</div>
                            </div>
                            <div class="topic-ideas-count">3 IDEAS</div>
                            <div class="topic-actions">
                                <button class="topic-btn">EDIT</button>
                                <button class="topic-btn">VIEW</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="status-bar">
                <div class="status-bar-section">Ready</div>
                <div class="status-bar-section">42 items</div>
                <div class="sizing-grip"></div>
            </div>
        </div>
    </div>

    <script src="window-manager.js"></script>
    <script>
        /**
         * Dashboard Demo - Uses WindowManager module for interactive windows
         *
         * Architecture:
         * - Universe contains My Life window (managed by universeWM)
         * - My Life contains nested windows (managed by myLifeWM)
         */
        (function() {
            const universe = document.getElementById('universe');
            const myLifeWindow = document.getElementById('mylife-window');
            const myLifeContent = document.getElementById('mylife-content');

            let universeWM = null;  // Manages windows in the Universe (My Life)
            let myLifeWM = null;    // Manages windows inside My Life

            // ===== Desktop Icon Selection =====
            const desktopIcons = document.querySelectorAll('.desktop-icon');
            desktopIcons.forEach(icon => {
                icon.addEventListener('click', function(e) {
                    desktopIcons.forEach(i => i.classList.remove('selected'));
                    this.classList.add('selected');
                });

                icon.addEventListener('dblclick', function() {
                    openMyLife();
                });
            });

            // Click on Universe to deselect icons
            universe.addEventListener('click', function(e) {
                if (e.target === this || e.target.classList.contains('desktop-icons')) {
                    desktopIcons.forEach(i => i.classList.remove('selected'));
                }
            });

            // Keyboard support
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Enter') {
                    const selected = document.querySelector('.desktop-icon.selected');
                    if (selected) {
                        openMyLife();
                    }
                }
                if (e.key === 'Escape' && myLifeWindow.style.display !== 'none') {
                    closeMyLife();
                }
            });

            // ===== My Life Window Functions =====
            function openMyLife() {
                myLifeWindow.style.display = 'flex';
                if (universeWM) {
                    universeWM.setActiveWindow(myLifeWindow);
                }
            }

            function closeMyLife() {
                myLifeWindow.style.display = 'none';
            }

            // ===== Initialize =====
            function init() {
                // Window manager for Universe level (My Life window)
                universeWM = new WindowManager(universe, {
                    onWindowClose: (win) => {
                        if (win.id === 'mylife-window') {
                            closeMyLife();
                        }
                    }
                });

                // Setup My Life window with universe manager
                universeWM.setupWindow(myLifeWindow);

                // Window manager for nested windows inside My Life
                myLifeWM = new WindowManager(myLifeContent, {
                    minWidth: 150,
                    minHeight: 100
                });

                // Initialize all nested windows inside My Life
                myLifeWM.initAllWindows();
            }

            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', init);
            } else {
                init();
            }
        })();
    </script>
</body>
</html>
